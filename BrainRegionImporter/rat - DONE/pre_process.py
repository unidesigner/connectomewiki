#!/usr/bin/env python

import csv

reader = csv.DictReader(open('table1.csv', "rb"), delimiter=';', fieldnames = ['from','a35','a36','ca1','ca3','dg','lea','mea','pas','por','prs','sub'])

bigdict = {}
for row in reader:
    bigdict[row['from']] = row

mapi = {'a35': 'BA35',
'a36': 'BA36',
'ca1': 'CA1',
'ca3': 'CA3',
'dg':  'DG',
'lea': 'LEA',
'mea': 'MEA',
'pas': 'PaS',
'por': 'POR',
'prs': 'PrS',
'sub': 'Sub',
}
pid={'216': '14750656', '217': '12106290', '215': '15196963', '212': '9187278', '213': '18067148', '211': '11345118', '218': '2392570', '219': '8773257', '133': '9136047', '132': '6883086', '131': '11345131', '130': '4458909', '135': '10911896', '134': '8987807', '139': '9703026', '138': '9703027', '93': '8929332', '24': '7538515', '25': '9348124', '26': '1727001', '224': '10102498', '20': '10583500', '21': '3379162', '23': '2358523', '222': '6180146', '4': '2409482', '121': '65364', '123': '6205726', '124': '3607449', '125': '1704281', '126': '1697208', '195': '18000818', '196': '12454982', '190': '6168668', '114': '15116384', '116': '9261838', '112': '11406828', '82': '9497153', '3': '9492202', '7': '2836479', '225': '8727002', '108': '7237176', '109': '6616174', '241': '5910903', '240': '4715298', '243': '17717699', '242': '3343404', '102': '1702115', '103': '7472444', '100': '690280', '101': '8821440', '106': '1270625', '104': '7714239', '33': '7534172', '32': '8429124', '31': '3958250', '30': '3902916', '247': '3374835', '35': '75894', '34': '632370', '246': '7397553', '178': '6643724', '177': '11370013', '175': '4907846', '174': '422759', '173': '7225870', '183': '72679', '180': '16987216', '2': '9700566', '186': '679029', '187': '16344147', '6': '7119174', '189': '9548550', '185': '2611653', '99': '8867038', '98': '3700723', '229': '17765735', '228': '8627369', '227': '7890833', '226': '2266195', '166': '17607757', '167': '17604355', '223': '8366344', '94': '8923527', '97': '7843307', '11': '5585500', '10': '972204', '13': '5073889', '12': '4112908', '14': '8269038', '150': '17559940', '155': '16359649', '154': '8124522', '157': '15961670', '238': '2329188', '239': '5823402', '234': '2085739', '235': '3683859', '236': '402984', '237': '891692', '230': '8738371', '231': '4118866', '232': '6374516', '233': '10848549', '5': '3020190', '201': '1744242', '144': '8300905', '145': '15140566', '142': '3401733', '207': '1713171', '148': '4106861', '76': '10401645'}
f = open('RAT_CON.txt', 'w')

for k,v in bigdict.items():
    if k == 'from':
        continue
    
    for kk, vv in v.items():
        if kk == 'from':
            continue
        # ids to pmids
        pids=vv.split(',')
        pidsn=[]
        for ii in pids:
            ii = ii.lstrip(' ')
            ii = ii.rstrip(' ')
            if pid.has_key(ii):
                pidsn.append(pid[ii])
            else:
                pass
                #pidsn.append('px'+str(ii))
        
        f.writelines([mapi[k],'-', mapi[kk], ';PMID:', ','.join(pidsn), '\n'])
        
f.close()